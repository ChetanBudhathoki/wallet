<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://fonts.googleapis.com/css2?family=Poppins&family=Raleway:ital,wght@1,400;1,900&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="style.css">

    <title>budgetapp</title>
</head>


<body>


    <div class="navigation">
        <input type="checkbox" name="navigation_checkbox" id="nav_toggle">
        <label for="nav_toggle" class="navigation_button">
            <ion-icon name="menu-outline" id="men"></ion-icon>
        </label>
        <div class="navigation_background">&nbsp;</div>
        <nav class="navigation_nav">

            <div class="navigation_nav_container">
                <div class="icon-1 menu_icons"><a href="index.html">Dashboard</a></div>
                <div class="icon-2 menu_icons"><a href="./view/add_transaction.html">Add Transactions</a> </div>
                <div class="icon-3 menu_icons"><a href="./view/income.html">Incomes</a> </div>
                <div class="icon-4 menu_icons"><a href="./view/expense.html">Expenses</a> </div>
                <div class="icon-5 menu_icons"><a href="">Graph</a> </div>
            </div>
            <!-- <ul class="navigation_list">
            <li class="navigation_item"><a href="https://www.facebook.com " target="_blank"
                    class="navigation_link">dashboard</a></li>
            <li class="navigation_item"><a href="#" class="navigation_link">Add Transaction</a></li>
            <li class="navigation_item"><a href="#" class="navigation_link">Incomes</a></li>
            <li class="navigation_item"><a href="#" class="navigation_link">take a Expenses</a></li>

        </ul> -->
    </div>
    <section class="dashboard">
        <div class="dashboard_container">
            <div class="budget_box boxes">
                <h4>Current Budget</h4>
                <h5 class="bibhu">12938488</h5>
            </div>
            <div class="income_box boxes">
                <h4>Total Income</h4>
                <h5 class="ram">83749347</h5>
            </div>
            <div class="expense_box boxes">
                <h4>Total Expenses</h4>
                <h5 class="laxman">84579457</h5>
                <h6 class="kalyan">45%</h6>
            </div>
        </div>
    </section>

    <section class="transaction_list">
        <div class="transaction_list_heading">
            Recent Transactions
        </div>
        <div class="transaction_list_container">
            <div class="transaction_list-1 lists">
                <span class="one spans">
                    <ion-icon name="chevron-up-outline" class="uparrow"></ion-icon>
                </span>
                <span class="two spans">
                    <p>Salary Paid</p>
                </span>
                <span class="three spans">98338737 </span>
                <span class="four spans">21%</span>

            </div>

            <!-- <div class="tra-1 transactions">one</div>
            <div class="tra-2 transactions">
                salary added  to facebook how do you like it
             </div>
            <div class="tra-3 transactions">903948484</div>
            <div class="tra-4 transactions">21%</div> -->


            <!-- separating line -->


            <!-- <div class="transaction_list-2 lists">
            <span id="one">
                <ion-icon name="chevron-up-outline" id="uparrow"></ion-icon>
            </span>
            <span id="two"><p>Interest</p></span>
            <span id="three">758654</span>
            <span id="four">78%</span>
        </div>
        <div class="transaction_list-3 lists">
            <span id="one">
                <ion-icon name="chevron-up-outline" id="uparrow"></ion-icon>
            </span>
            <span id="two"><p>Car Sold</p></span>
            <span id="three">864654</span>
            <span id="four">45%</span>
        </div>
        <div class="transaction_list-4 lists">
            <span id="one">
                <ion-icon name="chevron-up-outline" id="uparrow"></ion-icon>
            </span>
            <span id="two"><p>Fooding</p></span>
            <span id="three">245644</span>
            <span id="four">67%</span>
        </div>
        <div class="transaction_list-5 lists">
            <span id="one">
                <ion-icon name="chevron-up-outline" id="uparrow"></ion-icon>
            </span>
            <span id="two"><p>Clothing</p></span>
            <span id="three">9865478</span>
            <span id="four">31%</span>
        </div> -->
        </div>

    </section>

    <!-- <audio controls autoplay src="dil.MP3">whai is ghis</audio> -->
    <script src="copy.js"></script>
    <script>
        // document.addEventListener('DOMContentLoaded', tester);


        
        document.addEventListener('DOMContentLoaded',getcurrentbudget);
        function getcurrentbudget(){
            console.log('hellow world');
            
            var totalbudget=0;
            var expper=0;
            var income=0;
            var expense=0;
            var percentage=0;
            var delocalstorage=JSON.parse(localStorage.getItem('newitems'));
            var totaltrans=delocalstorage.alltransaction;
            totaltrans.forEach(element => {
                if(element.type==="inc"){
                    totalbudget+=element.value;
                    income+=element.value;

                }
                else{
                    totalbudget-=element.value;
                    expense+=element.value;
                    
                }
                
                

            });
            
            totalbudget>0? percentage=Math.round((expense/income)*100):0;
           

            document.querySelector('.bibhu').innerText=totalbudget;
            document.querySelector('.ram').innerText=income;
            document.querySelector('.laxman').innerText=`- ${expense}`;
            document.querySelector('.kalyan').innerText=`${percentage} %`;
            return {
                income:income,
                totalbudget:totalbudget
            };
        }


        if (localStorage.getItem('newitems')) {
            console.log('ghantako ready');
            // uiController.addListItem(e);
            var storedarray = JSON.parse(localStorage.getItem('newitems'));
            var inc_array = storedarray.inc;
            var exp_array = storedarray.exp;
            var alltransaction=storedarray.alltransaction;
 
            // for(let key in alltransaction.newitem){
            //     console.log(key);
            // }
            
            function tester(element) {
                var percentage;
                var income=getcurrentbudget();
                income.totalbudget<0?percentage=0:percentage=Math.round((element.value/income)*100);
                var html;

                // element= '.transaction_list_container';
                if(element.type==="inc"){
                    
                    html = '  <div class="transaction_list-1 lists" id="lists-0"><span class="one" id="one"><ion-icon name="chevron-up-outline" class="uparrow"></ion-icon></span><span class="two"><p>%description%</p></span><span class="three">%value% </span><span class="four"></span></div>'
                }
                else if(element.type==="exp"){
                    // percentage=Math.round((element.value/income)*100);
                //    percentage=percentage.toPrecision(2);
                
                    html = '  <div class="transaction_list-1 lists" id="lists-0"><span class="one" id="one"><ion-icon name="chevron-down-outline" class="downarrow"></ion-icon></span><span class="two"><p>%description%</p></span><span class="three">-%value% </span><span class="four">%hellow%</span></div>'
                }
                
              



                var storedarray = JSON.parse(localStorage.getItem('newitems'));



                var newhtmlobject = html.replace('%id%', element.id);
                newhtmlobject = newhtmlobject.replace('%description%',element.description);
                newhtmlobject = newhtmlobject.replace('%value%', element.value);
                newhtmlobject = newhtmlobject.replace('%hellow%', `${percentage} %`);


                document.querySelector('.transaction_list_container').insertAdjacentHTML('beforeend', newhtmlobject);




            };

            alltransaction.forEach(element => {
                tester(element);
            });


            // console.log(storedarray.inc[0].value);

            // inc_array.forEach(function () {
            //     var incomediv = document.createElement("div");
            //     incomediv.classList.add('lists');
            //     incomediv.innerText 
            //     console.log(incomediv);
            //     var test = document.querySelector('.transaction_list_container');
            //     test.appendChild(incomediv);
            //     var one = document.createElement('span');
            //     one.classList.add('one');
            //     one.innerHTML = ' <ion-icon name="chevron-up-outline" class="uparrow"></ion-icon>';
            //     incomediv.appendChild(one);

            // var arrow_icon=document.createElement('i');
            // arrow_icon.classList.add(uparrow);
            // var oone=document.querySelector('.one');
            // oone.appendChild(arrow_icon);


            // var two = document.createElement('span');
            // two.classList.add('two');
            // two.innerText = storedarray.inc[0].description;
            // incomediv.appendChild(two);

            // var p = document.createElement('p');
            // p.classList.add('try');
            // p.innerText = storedarray.inc[0].description;
            // var pq=document.querySelector('.two');
            // pq.appendChild(p);

            // var three = document.createElement('span');
            // three.classList.add('three');
            // three.innerText = storedarray.inc[0].value;
            // incomediv.appendChild(three);

            // var four = document.createElement('span');
            // four.classList.add('four');
            // four.innerText = 'four';
            // incomediv.appendChild(four);
            // }

            // );
        }
        tester();
    </script>
    <script src="https://unpkg.com/ionicons@5.2.3/dist/ionicons.js"></script>

</body>

</html>